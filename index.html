<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¤œç´¢ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ»ã‚«ã‚¹ã‚¿ãƒ ç‰ˆ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #f1f5f9; }
    .tag { transition: all 0.2s; }
    .tag:hover { transform: translateY(-1px); }
  </style>
</head>
<body class="p-4 sm:p-8">
  <div class="max-w-xl mx-auto bg-white rounded-3xl shadow-xl p-6 border border-gray-100">
    
    <header class="mb-6">
      <h1 class="text-2xl font-black text-gray-800 flex items-center gap-2">
        <span>ğŸ”</span> å¿«é©æ¤œç´¢ãƒ“ãƒ«ãƒ€ãƒ¼
      </h1>
      <p class="text-xs text-gray-500 mt-1">é™¤å¤–ãƒ¯ãƒ¼ãƒ‰ã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼†è‡ªå‹•ä¿å­˜</p>
    </header>

    <div class="mb-6">
      <label class="block mb-2 font-bold text-gray-700 text-sm">æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</label>
      <input type="text" id="mainKeyword" value="ã‚³ãƒˆãƒ€ãƒãƒ³" oninput="generateSearch()"
             class="w-full border-2 border-gray-100 p-3 rounded-2xl focus:border-blue-500 outline-none transition-all font-bold">
    </div>

    <div class="mb-6">
      <label class="flex items-center gap-3 p-4 bg-blue-50 rounded-2xl cursor-pointer border border-blue-100">
        <input type="checkbox" id="onlyOfficial" onchange="generateSearch()" class="w-5 h-5">
        <span class="font-bold text-blue-800 text-sm">å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã¿è¡¨ç¤º</span>
      </label>
    </div>

    <div class="mb-6">
      <label class="block mb-2 font-bold text-gray-700 text-sm">é™¤å¤–ãƒ¯ãƒ¼ãƒ‰ï¼ˆã‚¿ãƒƒãƒ—ã§ON/OFFï¼‰</label>
      
      <div class="flex gap-2 mb-4">
        <input type="text" id="newWordInput" placeholder="è¿½åŠ ã—ãŸã„ãƒ¯ãƒ¼ãƒ‰..." 
               class="flex-1 border-2 border-gray-50 p-2 rounded-xl text-sm outline-none focus:border-gray-300">
        <button onclick="addWord()" class="bg-gray-800 text-white px-4 py-2 rounded-xl text-sm font-bold hover:bg-black">
          è¿½åŠ 
        </button>
      </div>

      <div id="wordContainer" class="flex flex-wrap gap-2 min-h-[50px] p-3 bg-gray-50 rounded-2xl">
        </div>
      <p class="text-[10px] text-gray-400 mt-2 italic">â€» é•·æŠ¼ã—(ã¾ãŸã¯å³ä¸Šã®Ã—)ã§ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ã§ãã¾ã™</p>
    </div>

    <div class="mt-8 border-t pt-6">
      <textarea id="output" readonly
                class="w-full border-none bg-gray-100 p-4 rounded-2xl h-24 text-xs text-gray-500 mb-4 focus:outline-none italic"></textarea>
      
      <div class="grid grid-cols-2 gap-3">
        <button onclick="copyOutput()" class="bg-white border-2 border-gray-200 py-4 rounded-2xl font-bold text-sm hover:bg-gray-50 transition-all">
          ğŸ“‹ ã‚³ãƒ”ãƒ¼
        </button>
        <button onclick="executeSearch()" class="bg-blue-600 text-white py-4 rounded-2xl font-bold text-sm hover:bg-blue-700 transition-all shadow-lg shadow-blue-200 text-center">
          ğŸš€ Yahoo!æ¤œç´¢
        </button>
      </div>
    </div>

  </div>

  <script>
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ
    const defaultWords = ["ç„¡é™ç¦å¬å–šãƒã‚±ãƒƒãƒˆ", "xfl.ag", "çŸ³å¢", "è²·å–", "è²©å£²", "mirrativ", "å®Ÿç¸¾"];
    
    // çŠ¶æ…‹ç®¡ç†ï¼š{text: string, enabled: boolean}
    let excludeList = JSON.parse(localStorage.getItem('myExcludeList')) || 
                      defaultWords.map(w => ({text: w, enabled: true}));

    // è¡¨ç¤ºã®æ›´æ–°
    function renderWords() {
      const container = document.getElementById('wordContainer');
      container.innerHTML = '';
      
      excludeList.forEach((item, index) => {
        const span = document.createElement('div');
        span.className = `tag flex items-center gap-1 px-3 py-1.5 rounded-full border text-xs font-bold cursor-pointer select-none
          ${item.enabled ? 'bg-blue-600 text-white border-blue-600' : 'bg-white text-gray-400 border-gray-200'}`;
        
        // ã‚¯ãƒªãƒƒã‚¯ã§ON/OFF
        span.onclick = () => toggleWord(index);
        
        span.innerHTML = `
          <span>${item.text}</span>
          <span onclick="event.stopPropagation(); removeWord(${index});" class="ml-1 hover:text-red-300">Ã—</span>
        `;
        container.appendChild(span);
      });
      
      saveAndGenerate();
    }

    // ON/OFFåˆ‡ã‚Šæ›¿ãˆ
    function toggleWord(index) {
      excludeList[index].enabled = !excludeList[index].enabled;
      renderWords();
    }

    // ãƒ¯ãƒ¼ãƒ‰è¿½åŠ 
    function addWord() {
      const input = document.getElementById('newWordInput');
      const val = input.value.trim();
      if (val) {
        excludeList.push({text: val, enabled: true});
        input.value = '';
        renderWords();
      }
    }

    // ãƒ¯ãƒ¼ãƒ‰å‰Šé™¤
    function removeWord(index) {
      excludeList.splice(index, 1);
      renderWords();
    }

    // ä¿å­˜ã¨æ¤œç´¢å¼ç”Ÿæˆ
    function saveAndGenerate() {
      localStorage.setItem('myExcludeList', JSON.stringify(excludeList));
      generateSearch();
    }

    function generateSearch() {
      const keyword = document.getElementById('mainKeyword').value.trim();
      const onlyOfficial = document.getElementById('onlyOfficial').checked;
      
      const excludes = excludeList
        .filter(item => item.enabled)
        .map(item => `-"${item.text}"`)
        .join(' ');
      
      let officialTag = onlyOfficial ? "from:kotodaman_pr" : "";
      const fullQuery = `${keyword} ${officialTag} ${excludes}`.replace(/\s+/g, ' ').trim();
      document.getElementById('output').value = fullQuery;
    }

    function copyOutput() {
      const output = document.getElementById('output');
      navigator.clipboard.writeText(output.value);
      alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
    }

    function executeSearch() {
      const query = encodeURIComponent(document.getElementById('output').value);
      window.open(`https://search.yahoo.co.jp/realtime/search?p=${query}`, '_blank');
    }

    // åˆæœŸèµ·å‹•
    renderWords();





// ã‚µãƒ¼ãƒ“ã‚¹ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ç™»éŒ²
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => console.log('Service Worker registered!'))
      .catch(err => console.error('Service Worker registration failed:', err));
  });
}

  </script>
</body>
</html>
